{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "$id": "http://example.com/schemas/dungeon-crawler-schema.json",
  "title": "Dungeon Crawler Game Schema",
  "version": "1.0.0",
  "type": "object",
  "properties": {
    "appearances": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/appearance"
      }
    },
    "characteristics": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/characteristic"
      }
    },
    "behaviours": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/behaviour"
      }
    },
    "triggers": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/trigger"
      }
    },
    "conditions": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/condition"
      }
    },
    "effects": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/effect"
      }
    },
    "events": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/event"
      }
    }
  },
  "required": [
    "appearances",
    "characteristics",
    "behaviours",
    "triggers",
    "conditions",
    "effects",
    "events"
  ],
  "definitions": {
    "defaults": {
      "type": "object",
      "properties": {
        "required": {
          "type": "boolean"
        },
        "growth": {
          "type": "string",
          "enum": [
            "fixed",
            "variable"
          ]
        }
      },
      "required": [
        "required",
        "growth"
      ]
    },
    "property": {
      "type": "object",
      "properties": {
        "value": {
          "type": "integer",
          "maximum": 255
        },
        "name": {
          "type": "string",
          "maxLength": 128
        },
        "description": {
          "type": "string",
          "maxLength": 512
        }
      },
      "required": [
        "value",
        "name",
        "description"
      ]
    },
    "parameterValue": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "maximum": 255
        },
        "propertyIndex": {
          "type": "integer",
          "maximum": 255
        },
        "value": {
          "type": "integer",
          "maximum": 255
        }
      },
      "required": [
        "index",
        "propertyIndex",
        "value"
      ]
    },
    "pixel": {
      "type": "object",
      "properties": {
        "a": {
          "type": "integer"
        }
      },
      "required": [
        "a"
      ],
      "allOf": [
        {
          "if": {
            "properties": {
              "a": {
                "const": 0
              }
            }
          },
          "then": {
            "$ref": "#/definitions/dataPixel"
          },
          "else": {
            "$ref": "#/definitions/visualPixel"
          }
        }
      ]
    },
    "dataPixel": {
      "type": "object",
      "properties": {
        "a": {
          "const": 0
        },
        "r": {
          "type": "integer"
        }
      },
      "required": [
        "a",
        "r"
      ],
      "oneOf": [
        {
          "$ref": "#/definitions/characteristicPixel"
        },
        {
          "$ref": "#/definitions/behaviourPixel"
        },
        {
          "$ref": "#/definitions/eventPixel"
        }
      ]
    },
    "visualPixel": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255
        },
        "r": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255,
          "default": 255
        },
        "g": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255,
          "default": 255
        },
        "b": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255,
          "default": 255
        },
        "a": {
          "type": "integer",
          "minimum": 1,
          "maximum": 255,
          "default": 255
        }
      },
      "required": [
        "index",
        "r",
        "g",
        "b",
        "a"
      ]
    },
    "characteristicPixel": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255
        },
        "r": {
          "type": "integer",
          "minimum": 40,
          "maximum": 89
        },
        "g": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255
        },
        "b": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255
        },
        "a": {
          "type": "integer",
          "const": 0
        }
      },
      "required": [
        "index",
        "r",
        "g",
        "b",
        "a"
      ]
    },
    "behaviourPixel": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255
        },
        "r": {
          "type": "integer",
          "minimum": 90,
          "maximum": 139
        },
        "g": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255
        },
        "b": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255
        },
        "a": {
          "type": "integer",
          "const": 0
        }
      },
      "required": [
        "index",
        "r",
        "g",
        "b",
        "a"
      ]
    },
    "eventPixel": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255
        },
        "r": {
          "type": "integer",
          "minimum": 140,
          "maximum": 255
        },
        "g": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255
        },
        "b": {
          "type": "integer",
          "minimum": 0,
          "maximum": 255
        },
        "a": {
          "type": "integer",
          "const": 0
        }
      },
      "required": [
        "index",
        "r",
        "g",
        "b",
        "a"
      ]
    },
    "appearance": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 0,
          "maximum": 39
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "defaults": {
          "$ref": "#/definitions/defaults"
        },
        "properties": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "value": {
                "type": [
                  "integer",
                  "string",
                  "boolean",
                  "number"
                ]
              },
              "name": {
                "type": "string"
              },
              "description": {
                "type": "string"
              }
            },
            "required": [
              "value",
              "name",
              "description"
            ]
          }
        },
        "pixels": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/pixel"
          },
          "minItems": 256,
          "maxItems": 256,
          "uniqueItemProperties": [
            "index"
          ],
          "allOf": [
            {
              "contains": {
                "$ref": "#/definitions/visualPixel"
              },
              "minContains": 156,
              "maxContains": 156
            },
            {
              "contains": {
                "$ref": "#/definitions/characteristicPixel"
              },
              "minContains": 20,
              "maxContains": 20
            },
            {
              "contains": {
                "$ref": "#/definitions/behaviourPixel"
              },
              "minContains": 20,
              "maxContains": 20
            },
            {
              "contains": {
                "$ref": "#/definitions/eventPixel"
              },
              "minContains": 60,
              "maxContains": 60
            }
          ]
        }
      },
      "required": [
        "index",
        "name",
        "description",
        "defaults",
        "properties",
        "pixels"
      ]
    },
    "characteristic": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 40,
          "maximum": 89
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "defaults": {
          "$ref": "#/definitions/defaults"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/property"
          }
        }
      },
      "required": [
        "index",
        "name",
        "description",
        "defaults",
        "properties"
      ]
    },
    "behaviour": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 90,
          "maximum": 139
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "defaults": {
          "$ref": "#/definitions/defaults"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/property"
          }
        }
      },
      "required": [
        "index",
        "name",
        "description",
        "defaults",
        "properties"
      ]
    },
    "trigger": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 190,
          "maximum": 209
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "defaults": {
          "$ref": "#/definitions/defaults"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/property"
          }
        }
      },
      "required": [
        "index",
        "name",
        "description",
        "defaults",
        "properties"
      ]
    },
    "condition": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 230,
          "maximum": 255
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "defaults": {
          "$ref": "#/definitions/defaults"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/property"
          }
        }
      },
      "required": [
        "index",
        "name",
        "description",
        "defaults",
        "properties"
      ]
    },
    "effect": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 210,
          "maximum": 229
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "defaults": {
          "$ref": "#/definitions/defaults"
        },
        "properties": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/property"
          }
        }
      },
      "required": [
        "index",
        "name",
        "description",
        "defaults",
        "properties"
      ]
    },
    "event": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 140,
          "maximum": 169
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "defaults": {
          "$ref": "#/definitions/defaults"
        },
        "triggers": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/parameterValue"
          },
          "uniqueItemProperties": [
            "index",
            "propertyIndex"
          ]
        },
        "conditions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/parameterValue"
          },
          "uniqueItemProperties": [
            "index",
            "propertyIndex"
          ]
        },
        "effects": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/parameterValue"
          },
          "uniqueItemProperties": [
            "index",
            "propertyIndex"
          ]
        },
        "appliesTo": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/parameterValue"
          },
          "uniqueItemProperties": [
            "index",
            "propertyIndex"
          ]
        }
      },
      "required": [
        "index",
        "name",
        "description",
        "defaults",
        "triggers",
        "conditions",
        "effects",
        "appliesTo"
      ]
    }
  }
}